<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Yin Yang — Multi-Mode Spinner</title>

<style>
  html, body {
    margin: 0;
    background: black;
    height: 100%;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: system-ui, sans-serif;
    color: #ddd;
  }

  #container {
    position: relative;
    width: 420px;
    height: 420px;
  }

  @media (max-width: 520px) {
    #container { width: 320px; height: 320px; }
    #hud { bottom: -140px; }
    input[type="range"] { width: 210px; }
  }

  svg {
    width: 100%;
    height: 100%;
    transform-origin: 50% 50%;
    transform-box: fill-box;
    will-change: transform;
  }

  #hud {
    position: absolute;
    bottom: -120px;
    width: 100%;
    text-align: center;
    font-size: 14px;
    opacity: 0.88;
    user-select: none;
  }

  .row {
    margin-top: 6px;
  }

  input[type="range"] {
    width: 240px;
  }

  .small {
    font-size: 12px;
    opacity: 0.72;
    margin-top: 8px;
    line-height: 1.4;
  }

  kbd {
    background: #222;
    border: 1px solid #555;
    border-radius: 4px;
    padding: 1px 5px;
  }

  .controls {
    display: inline-flex;
    gap: 8px;
    margin-top: 8px;
    flex-wrap: wrap;
    justify-content: center;
  }

  button {
    background: #111;
    color: #ddd;
    border: 1px solid #444;
    border-radius: 10px;
    padding: 6px 10px;
    cursor: pointer;
  }

  button:active { transform: translateY(1px); }

  .paused {
    opacity: 0.6;
  }
</style>
</head>

<body>
<div id="container">

  <svg id="spinner" viewBox="-100 -100 200 200" aria-label="Yin Yang spinner" role="img">
    <!-- outer disk -->
    <circle id="outer" r="100" fill="white"/>

    <!-- yin-yang curve -->
    <path id="half" d="
      M 0 -100
      A 100 100 0 0 1 0 100
      A 50 50 0 0 0 0 0
      A 50 50 0 0 1 0 -100
    " fill="black"/>

    <!-- lobes -->
    <circle id="lobe1" cx="0" cy="-50" r="50" fill="white"/>
    <circle id="lobe2" cx="0" cy="50"  r="50" fill="black"/>

    <!-- dots ("eyes") -->
    <circle id="dot1" cx="0" cy="-42" r="14" fill="black"/>
    <circle id="dot2" cx="0" cy="42"  r="14" fill="white"/>
  </svg>

  <div id="hud">
    <div>
      <strong>RPM:</strong>
      <span id="rpm">0.0</span>
      <span id="state"></span>
    </div>

    <div class="row">
      <!-- Start at a calm 20 RPM by default -->
      <input id="rpmSlider" type="range" min="0" max="600" step="1" value="20" />
      <span><strong>Target:</strong> <span id="rpmTarget">20</span></span>
    </div>

    <div class="controls">
      <button id="toggleBtn" type="button">Pause</button>
      <button id="resetBtn" type="button">Reset</button>
      <button id="zeroBtn" type="button">0 RPM</button>
      <button id="modeBtn" type="button">Mode</button>
    </div>

    <div class="small">
      <strong>Mode:</strong> <span id="modeName"></span><br>
      <kbd>Space</kbd> start/stop · <kbd>↑</kbd>/<kbd>↓</kbd> speed · <kbd>R</kbd> reset · <kbd>M</kbd> mode
    </div>
  </div>

</div>

<script>
  const spinner = document.getElementById("spinner");

  const outer = document.getElementById("outer");
  const half  = document.getElementById("half");
  const lobe1 = document.getElementById("lobe1");
  const lobe2 = document.getElementById("lobe2");
  const dot1  = document.getElementById("dot1");
  const dot2  = document.getElementById("dot2");

  const rpmEl = document.getElementById("rpm");
  const stateEl = document.getElementById("state");
  const slider = document.getElementById("rpmSlider");
  const rpmTargetEl = document.getElementById("rpmTarget");

  const toggleBtn = document.getElementById("toggleBtn");
  const resetBtn = document.getElementById("resetBtn");
  const zeroBtn = document.getElementById("zeroBtn");
  const modeBtn = document.getElementById("modeBtn");
  const modeNameEl = document.getElementById("modeName");

  let angle = 0;         // degrees
  let speed = 0;         // deg/sec
  let running = true;    // auto-start spinning

  // Start at the slider value (20 RPM) for a smooth ramp-up
  let targetRPM = Number(slider.value);

  let last = performance.now();
  let hue = 0;

  // indexed hue stepping
  const steps = 24;
  const stepSize = 360 / steps;

  function rpmToDeg(rpm) { return rpm * 6; } // 1 RPM = 6 deg/sec

  function hsl(h) {
    return `hsl(${(h % 360 + 360) % 360},100%,60%)`;
  }

  function updateColors() {
    outer.setAttribute("fill", hsl(hue));
    half.setAttribute("fill", hsl(hue + 180));
    lobe1.setAttribute("fill", hsl(hue + 90));
    lobe2.setAttribute("fill", hsl(hue + 270));
    dot1.setAttribute("fill", hsl(hue + 180));
    dot2.setAttribute("fill", hsl(hue));
  }

  function classicColors() {
    outer.setAttribute("fill", "white");
    half.setAttribute("fill", "black");
    lobe1.setAttribute("fill", "white");
    lobe2.setAttribute("fill", "black");
    dot1.setAttribute("fill", "black");
    dot2.setAttribute("fill", "white");
  }

  function setDotStroke(on) {
    if (on) {
      dot1.setAttribute("stroke", "white");
      dot1.setAttribute("stroke-width", "2");
      dot2.setAttribute("stroke", "black");
      dot2.setAttribute("stroke-width", "2");
    } else {
      dot1.removeAttribute("stroke");
      dot1.removeAttribute("stroke-width");
      dot2.removeAttribute("stroke");
      dot2.removeAttribute("stroke-width");
    }
  }

  function setRunning(isRunning) {
    running = isRunning;
    toggleBtn.textContent = running ? "Pause" : "Start";
    stateEl.textContent = running ? "" : " (paused)";
    rpmEl.classList.toggle("paused", !running);
  }

  function resetAll() {
    // Reset remains your "demo" preset
    targetRPM = 400;
    slider.value = 400;
    rpmTargetEl.textContent = "400";

    // Smooth reset: ease back to target speed
    speed = 0;

    angle = 0;
    hue = 0;
    spinner.style.transform = "rotate(0deg)";

    modes[modeIndex].onEnter?.();
  }

  // ----- MODES -----
  let modeIndex = 1; // default to Indexed Color (Stepped)
  const modes = [
    {
      name: "Classic (B/W)",
      onEnter() {
        setDotStroke(false);
        classicColors();
      },
      update(dt) {
        // no extra work
      }
    },
    {
      name: "Indexed Color (Stepped)",
      onEnter() {
        setDotStroke(false);
        updateColors();
      },
      update(dt) {
        hue += (speed * 0.02 * dt);
        hue = Math.round(hue / stepSize) * stepSize;
        updateColors();
      }
    },
    {
      name: "Outlined Eyes (Smooth Hue)",
      onEnter() {
        setDotStroke(true);
        updateColors();
      },
      update(dt) {
        hue += (speed * 0.02 * dt); // smooth hue (no stepping)
        updateColors();
      }
    }
  ];

  function applyMode(i) {
    modeIndex = (i + modes.length) % modes.length;
    modeNameEl.textContent = modes[modeIndex].name;
    modes[modeIndex].onEnter?.();
  }

  function nextMode() { applyMode(modeIndex + 1); }

  // ----- UI EVENTS -----
  slider.addEventListener("input", () => {
    targetRPM = Number(slider.value);
    rpmTargetEl.textContent = slider.value;
  });

  toggleBtn.addEventListener("click", () => setRunning(!running));
  resetBtn.addEventListener("click", resetAll);

  zeroBtn.addEventListener("click", () => {
    targetRPM = 0;
    slider.value = 0;
    rpmTargetEl.textContent = "0";
  });

  modeBtn.addEventListener("click", nextMode);

  window.addEventListener("keydown", (e) => {
    if (e.key === " ") {
      e.preventDefault();
      setRunning(!running);
    }

    if (e.key === "m" || e.key === "M") {
      nextMode();
    }

    if (e.key === "r" || e.key === "R") {
      resetAll();
    }

    if (e.key === "ArrowUp") {
      targetRPM = Math.min(600, targetRPM + 5);
      slider.value = targetRPM;
      rpmTargetEl.textContent = targetRPM;
    }

    if (e.key === "ArrowDown") {
      targetRPM = Math.max(0, targetRPM - 5);
      slider.value = targetRPM;
      rpmTargetEl.textContent = targetRPM;
    }
  });

  // ----- ANIMATION LOOP -----
  function tick(now) {
    const dt = (now - last) / 1000;
    last = now;

    if (running) {
      const targetSpeed = rpmToDeg(targetRPM);

      // Smooth acceleration toward target (already feels great)
      speed += (targetSpeed - speed) * Math.min(1, 10 * dt);

      angle = (angle + speed * dt) % 360;
      spinner.style.transform = `rotate(${angle}deg)`;

      rpmEl.textContent = (speed / 6).toFixed(1);

      modes[modeIndex].update?.(dt);
    }

    requestAnimationFrame(tick);
  }

  // init (auto-start)
  applyMode(modeIndex);
  setRunning(true);
  requestAnimationFrame(tick);
</script>

</body>
</html>

